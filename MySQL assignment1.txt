mysql> CREATE DATABASE bank;
mysql> USE bank;
Database changed

mysql> CREATE TABLE customer_master (
    -> account_number int,
    -> customer_number int,
    -> first_name varchar(20),
    -> last_name varchar(20),
    -> account_opening_date date,
    -> customer_city varchar(20));

mysql> INSERT INTO customer_master VALUES (
    -> 1122,11,'aaa','bbb','2020-01-11','chennai'),
    -> (2233,12,'bbb','ccc','2020-07-22','madurai'),
    -> (3344,13,'bbb','ccc','2020-02-23','madurai'),
    -> (4455,14,'ccc','ddd','2020-10-24','coimbatore'),
    -> (5566,15,'ddd','eee','2020-02-18','chennai'),
    -> (6677,16,'aaa','bbb','2020-03-21','salem'),
    -> (7788,17,'eee','ggg','2020-08-23','salem');

mysql> SELECT * FROM customer_master;
+----------------+-----------------+------------+-----------+------------------------+---------------+
| account_number | customer_number | first_name | last_name | account_opening_date   | customer_city |
+----------------+-----------------+------------+-----------+------------------------+---------------+
|           1122 |             11  | aaa        | bbb       | 2020-01-11             | chennai       |
|           2233 |             12  | bbb        | ccc       | 2020-07-22             | madurai       |
|           3344 |             13  | bbb        | ccc       | 2020-02-23             | madurai       |
|           4455 |             14  | ccc        | ddd       | 2020-10-24             | coimbatore    |
|           5566 |             15  | ddd        | eee       | 2020-02-18             | chennai       |
|           6677 |             16  | aaa        | bbb       | 2020-03-21             | salem         |
|           7788 |             17  | eee        | ggg       | 2020-08-23             | salem         |
+----------------+-----------------+------------+-----------+------------------------+---------------+

mysql> CREATE TABLE account_master (customer_number int);

mysql> INSERT INTO account_master VALUES (11),(12),(13),(16),(17);

mysql> SELECT * FROM account_master;
+-----------------+
| customer_number |
+-----------------+
|             11 |
|             12 |
|             13 |
|             16 |
|             17 |
+-----------------+

mysql> CREATE TABLE loan_details (
    -> customer_number int,
    -> loan_amount varchar(10));

mysql> INSERT INTO loan_details
    -> VALUES (11,'1 lakh'),
    -> (12,'2 lakhs'),
    -> (13,'3 lakhs'),
    -> (15,'5 lakhs'),
    -> (16,'6 lakhs');

mysql> SELECT * FROM loan_details;
+-----------------+-------------+
| customer_number | loan_amount |
+-----------------+-------------+
|             11  | 1 lakh      |
|             12  | 2 lakhs     |
|             13  | 3 lakhs     |
|             15  | 5 lakhs     |
|             16  | 6 lakhs     |
+-----------------+-------------+

1) Write a query to display account number,customer_number,first_name,last_name,account_opening_date.
Display the records sorted in ascending order based on account number.

ANSWER : 

mysql> SELECT account_number,am.customer_number,first_name,last_name,account_opening_date
    -> FROM customer_master cm INNER JOIN account_master am
    -> ON cm.customer_number=am.customer_number
    -> ORDER BY account_number;
+----------------+-----------------+------------+-----------+----------------------+
| account_number | customer_number | first_name | last_name | account_opening_date |
+----------------+-----------------+------------+-----------+----------------------+
|           1122 |             11  | aaa        | bbb       | 2020-01-11           |
|           2233 |             12  | bbb        | ccc       | 2020-07-22           |
|           3344 |             13  | bbb        | ccc       | 2020-02-23           |
|           6677 |             16  | aaa        | bbb       | 2020-03-21           |
|           7788 |             17  | eee        | ggg       | 2020-08-23           |
+----------------+-----------------+------------+-----------+----------------------+

2) Write a query to display the number of customer's from Chennai.Give the count an alias name of cus_count.

ANSWER :

mysql> SELECT count(customer_number) cus_count
    -> FROM customer_master WHERE customer_city='chennai';
+-----------+
| cus_count |
+-----------+
|         2 |
+-----------+

3) Write a query to display customer_number,first_name,account_number for the customer's whose accounts were created after 15th of any month.
Display the records orted in ascending order based on customer number and then by account number.

ANSWER : 

mysql> SELECT am.customer_number,first_name,account_number
    -> FROM customer_master cm INNER JOIN account_master am ON cm.customer_number=am.customer_number
    -> WHERE extract(day from account_opening_date)<20
    -> ORDER BY am.customer_number,account_number;
+-----------------+------------+----------------+
| customer_number | first_name | account_number |
+-----------------+------------+----------------+
|             11  | aaa        |           1122 |
|             15  | ddd        |           5566 |
+-----------------+------------+----------------+

4) Write a query to display the number of customers who have registration but no account in the bank.

ANSWER :

mysql> SELECT count(customer_number) Count_Master
    -> FROM customer_master
    -> WHERE customer_number NOT IN (SELECT customer_number FROM account_master);
+--------------+
| Count_Master |
+--------------+
|            2 |
+--------------+

5) Write a query to display the firstname of the customer who have more than 1 account.Display the records in sorted order based on firstname.

ANSWER :

mysql> SELECT first_name
    -> FROM customer_master cm INNER JOIN account_master am ON cm.customer_number=am.customer_number
    -> GROUP BY first_name
    -> HAVING COUNT(account_number)>1
    -> ORDER BY first_name;
+------------+
| first_name |
+------------+
| aaa        |
| bbb        |
+------------+

6) Write a query to display the number of clients who have asked for loans but they don't have any account in the bank 
through they are registered customers.Give the count an alias name of Count.

ANSWER :

mysql> SELECT COUNT(id.customer_number) Count
    -> FROM customer_master cm INNER JOIN loan_details id ON cm.customer_number=id.customer_number
    -> WHERE cm.customer_number
    -> NOT IN(SELECT customer_number FROM account_master);
+-------+
| Count |
+-------+
|     1 |
+-------+

7) Write a query to display the customer's first name who have multiple accounts(atleast 2 accounts).
Display the records in ascending order based on customer's firstname.

ANSWER :

mysql> SELECT first_name
    -> FROM customer_master cm INNER JOIN account_master am ON cm.customer_number=am.customer_number
    -> GROUP BY first_name
    -> HAVING COUNT(first_name)>=2
    -> ORDER BY first_name;
+------------+
| first_name |
+------------+
| aaa        |
| bbb        |
+------------+